<script lang="ts">
    import { onMount } from "svelte";
    import { blur } from "svelte/transition";

    import AnimeCore from "$icons/AnimeCore.svelte";

    let CHOICE_NUMBER: number;
    let CHOICES: Array<{
        type: string;
        name: string;
        image: string;
        credit?: string;
    }> = [
        {
            type: "anime",
            name: "Demon Slayer",
            image: "/posters/demon-slayer.webp",
            credit: "https://www.reddit.com/r/DemonSlayerAnime/comments/tpgpid/demon_slayer_4k_wallpaper/"
        },
        {
            type: "anime",
            name: "Attack on Titan",
            image: "/posters/attack-on-titan.jpg"
        },
        {
            type: "anime",
            name: "Comic Girls",
            image: "/posters/Comic-Girls-Image.png"
        }
    ];

    onMount(() => {
        setInterval(() => {
            const index = Math.floor(Math.random() * CHOICES.length);
            CHOICE_NUMBER = index;
            console.log(index);
        }, 2000);
    });
</script>

<svelte:head>
    {#each CHOICES as item}
        <link
            rel="preload"
            as="image"
            href={item.image}
        />
    {/each}
</svelte:head>

<div class="grid h-screen">
    <!-- Background Image Container -->
    {#each CHOICES as item}
        {#if CHOICES.indexOf(item) == CHOICE_NUMBER}
            {@const type = () => {
                switch (item.type) {
                    case "anime":
                        return "the anime";
                    case "pixiv":
                        return "the artist";
                    default:
                        return "";
                }
            }}

            <div
                transition:blur|local
                class="bg-black h-screen fixed"
                style="grid-area: 1 / 1 / 2 / 2;"
            >
                <div
                    class="h-screen w-screen bg-no-repeat bg-center bg-cover brightness-90"
                    style="background-image:url('{item.image}')"
                />
                <div
                    class="absolute inset-0 bg-gradient-to-t from-base-100 via-base-100/[.8] md:via-base-100/[.0001]"
                />

                <!-- Top animecore logo div  -->
                <div class="absolute top-8 left-8">
                    <AnimeCore
                        width="164"
                        height="25"
                    />
                </div>
                <!-- Background from anime div  -->
                <div class="absolute bottom-8 left-8">
                    <div class="flex flex-col">
                        <div class="text-secondary">Background from {type()}</div>
                        <div class="text-white">{item.name}</div>
                    </div>
                </div>
            </div>
        {/if}
    {/each}
    <div class="h-screen grid absolute inset-0">
        <slot />
    </div>
</div>
